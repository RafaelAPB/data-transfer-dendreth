# Data transfers with DendrETH

## Getting Started

Tested with Now using node v18.17.1 (npm v9.6.7). System Version: macOS 14.0 (23A344). Kernel Version: Darwin 23.0.0. Git module versions as of 2Oct2023.
Install Foundry: https://book.getfoundry.sh/getting-started/installation

Install dependencies with ``yarn install`` and ``make install``.

To compile contracts run ``forge build``.

To run a local network run: ``anvil -p 9545 -a 2 --balance 3000``.

To deploy the contracts run ``./scripts/deploy-anvil.sh``. You can also deploy them on live testnets.

To run the tests run ``forge test``.

Scripts to deploy different contracts are under ``/scripts``.


#### Fork testing

Polygon block number: 33354559

Block goerli: 8688659
state root: 0x4f8d419923334e5cba865a70865dcce32028261d64694211703798eb65d1b084

#### Run 1 test from 1 file
``% source .env && forge test -vvvvv --fork-url $RPC_URL_MUMBAI --fork-block-number 33359283 --match-contract RelayTest --match-test testDeployedRelay``


#### Deploy proxy (reads deployed contracts from .env):

``forge script script/DeployModifiedProxy.t.sol $RPC_URL  --private-key $ANVIL_KEY --broadcast --ffi``


#### Debug
``forge debug --debug test/ProxyContract.t.sol --sig "testMigration(bytes)" "0xf90cd0b846f8440180a03fcbafa6ca73b02e94389366045bb7af054fed82efb39b73d62a8a540bd22d85a088d7dd23f7f709c1f89fde0acb20211e8f4fcc1dfb2f9c4f84672583cc29d649b90c84f90c81f90211a099fdbc31f71eadcdca6140f2df9de6a860a874999289cc0c2bdd9a3a01b43444a0299b4f5ebb01461bf12d64d793146b36256412657f0de0d4bf552bcf82d5292ca065c06802c64879978ca15ede142886b358f18938a92a6aaebbc73ada053edfcba0dd694bdaa66fedc65ace898c7151b627352b2b0850db0b48769a3d6dfeac40bba0395c36a982899e41b23307056c6172d9112b0d816fcf0d8fdd7c1b7d94fad5eea0b34d1a14e77345fe15254b621f4b0cc32b937178ac9b46b90179fd8f6b9031e6a0148079c21062d920ced8ea48a124a46addcde4be47298f0c4a389c5509a8efbfa08b917ccffe3cfe9d0bf2d807cb6f7409cc3f298767208767b27e7bc43efa2c83a03456106788396d69fabc2b3d5d48403eef331323f6a0bc72534521a6f1f97d76a0d2031d2e73d045038a5bfb11b0d374402792c9978fa15dd732f3397fb3c17ed0a04aef6a80ef92a79e20bfe9cd538acf8e348404e5f42a51fb5b4b7ddbe17a889ea0fa1d23ed4f1c8362db7327ccb458717d310115b16d7b3cbb88531513a2e54591a07db73e2e5902f11d844b856eb02ebec0c133d3314466fbb04a1512f7e1e7bdc0a092b26b19d281a978e8cd8bda737d7f6e406b418d1ea3436b6faa24990aae0d7aa0aa1c07deb3565293bf5fdad38c2d554314fdbf056a7b3f009b980c9a3599cfd5a0d36599f757bc1876ae4f5d33765b7aa960fef9f75f0805d95882e9614ee8805a80f90211a0083c4111ed0fde340bc0647920cf08c2147d6b3715b11734526742858a0105dfa064c8de048489fffae5687c764e258d78d5a33912781a8236185cf2dec05e1120a08247119927fb14e5eace2128a774812a98824224b5cf9e25534bb52da26dcc7da03801bf5f48f4a35c76516dabbd268afe5ff8b42165333ce42beba310b16515bca074edabc2a6cc5c5ca851196baaf8128f5faa125d83fa1d834a6c6ae5831b7d4da071e0828b19a661eb0e0331f360c50c2689f2faf762c7ee63fc2992ffc2d5fce6a0f7b39a564b228df41600c533c3d1af2c114cf04756f694b577b23486a81da725a0dd2f946be2665e17ebd6eda6ef694c0ab6302786c6614fb342647d7eff7d09bea02fddb142441489da753e89b74f106a5b9a20f6bb2514b2bbd6462590167f3c69a04f1e12b674f11313b5be7094ae2dc76c9f5348e85cc45deb0c0a16d43930080fa05661000733ffec10b1c853a1de83e13cd5769e5d9a588a588d1aed633d722457a0d4f767c163fb5d06c5436d770b80fca0e73a4f0b084afb845116bf56b71521a2a0e0ed25d77e27e355066f92fdb760bab2477391e0493f264bc9cf3608584c0b1da0673fae0fcdb62889ae16803724de826e8efa5673f9521ab686ddb4edbbc85751a0577f2ba75396c2dcf41328cd4a80917025bfd7b563feb4437d98b4d853616df6a02f5c9af3568a7e182e8af689752548700a5491c36bf2419110d6a61ed9c8f8bd80f90211a0d0a9ab885c59d54cf6d29718127ba2fa40e15874c10b7b1cd2d388659c8091c2a01b4266337e80ed9f1a767630b7611534d63fe6cea6857d49c8198276a484a29aa0dc4d9c0451a23923fe171af9eef73f1cd8b5d38d36c685ad6fba8eb12887560ca0ed6a577f6be36f7ed7ab7dbda960c6cb606885f2544bc9554b862611d5d6bdeea0a983527cf52424392d3653d48ff16f01828211ba3e7e9a7d6debca466aaff934a032100682858ecea90d7a5c1d5a2f21d877870e54a5768306e3fe0388675729e5a0a1b112df163192ca088a0d76999a45e9141fc83b66d592edc1a5b19ead911a99a0886b72326f67625f387420fd348e3b0bfab3196ac23529e26728a9d245c1ca28a0128f1c85d1a45381e9f4bc8d353d3435ac2ed3a00b6f407fd81a0e8b88de51e3a00b3cb4b2366e69446c0c39612da8fdfc9815649a7f60d8ba15665b10e7390541a0483a185a340ddd5ad11797a39dfdd92e0c3f6818d0c472aa4749f3bbf4024bbda05b4f63a7d928fa203a808331e074235c5d31014335472e620965556921774010a0827b9a593fc38220c70e85e2d1ce9643f4f2835fc59c4e6b2416884cbcec261ea0d7d86404baeca036578d6cc0a0c105b59bfb8a13522d34b36828d39d0bd3cbd6a086fafbb3394c57a85ee359bc435382cdd515900f0d05e500b4c090b576e6d6f5a0c089af0a88d3ec26d9ef824c776c7fae35ee1d9dc12347ce8c05d1a07cac91a780f90211a0521b4f9fb4f92290f9f285c8770c742d281a42179b8bff0108959c5d7f6c8b39a0a6038f7e42664e60bd4695c66c5c90a965dc3ae734f94ac3111a11c1fba8a787a04883eea260f9cba7a69cb457cc92d53e5370c79dc8e0edd829ea72727048bd5da052c9a00171c1b4a8b0c0689642c5c7a57950011dbfc0e03ba7be3229e4c7e98ba0b3a6e01935218b7755ae3235714f2f963398a56028ff324e387fedd126bad2e8a0c900c49bf24ba2e29978399306d8df4b9d6c8b459de45a338c5e1516cff652b2a03f115543fc39ca019a0a74fcd4e436c5addf68743a7cbc154f4fb473e397f521a0c3bd6a5bf563a16b96707ad812c99115a347ac0f4228bc0e66b4735d98fca750a0f6b3b2cac0a8728162b9dbef6bc30f83b5b8a21d5fcf9e53c9c4f61f059a88c0a0faabe1b7b1993545593a2b78bebd89cd893bf26193086d43f2a4390fefa81b69a09a5d90718ac3fcf49b1376ce90728ce527581a6c8e5531ee8b40a2b9b9d81b98a0ac5ada2f4e4a2889958dd36e0643924fec4626a6f40b1f701342fc55ed1419c5a063184fe979c31382c14cd6ac1094ccdf5c94cf5f305c76874f05d5f4228e53b6a08a8686c920f2747d83bc9d25fc25e28291bb8bc42835f0f83b36421c46af4b57a001caf8f53cccba4f63ad2cf287327990b0805252cbcae8313e341166627af808a0057a42864b41050042d86bec316058f6b85ed7b42b144b855db83900a9c4c01780f90211a0eacf5c28c08dfc2f0c29e3e7b22f2e5153aad6d03c63bff60a1722e62aee12b5a0aacc5adf050841d90d133f1e34e8ef69a5a6237825d4d65dcf8533f81d868960a0c43ee7e0fdd4ddb5658bc3340d7e4aafb26441433ed9f572ec985bb1ba00eec6a0de35f57ded295f201e0dc9da79b8d3a01f7aa5d825d9bba33c90aad9a4e223a2a087dc648aee520300e3c12903de44750529d3ec84f829a2764c49fa44de5afb8fa0b092c3c001c2dfa5e90314693dd8cf960a871a4b322bda649e8d2b1bb8bc0ed4a0662ae26da46bdf0bbf24e5716caf61c49c37058acd1d20414ab01badbfa5cdbda052759a5d8f4d2a26876b1dd825e6c8e5afd7a19a832a5b25a3d9f04d14c6f3a9a02f709ee534e06a12f8c01b23e1519d1b045115315312efda2093f45222fc5d58a04a147abad7855dd85b9909a239d2ce09bb5dd68c75852688a9266336ad600ba4a02051a1cd7d4c0a61651c60475831e122e44af51820a77e6b7821c3f88472baa0a0f1bc9a083436ac274d6d51f896a426f9914d508072d1fea82cb2c8ce10cdba4da0ce98690559ca30cf51eba9975c7cd5e1d0b2393d5b31526dcf3bbed2e22b0cbba05b9fca2ec38fe5aef66163358f7b5115b8a96965eb77d0f4be4931c92786db2aa09e2aa251d6f33ee2c003b30b084dff7932ab054087d655bc04b5d1d0acea29b4a0ad888eb36a0adfd76ca6524355a9662137c697267b50344539a2528ef15d519e80f901b1a094f82d806a145c3a5d92747a2d98ee4306f7ec520fda011602183bd8eba4d85ca0bc48b6ccd76af39cd24f5bc87ac442e1e1adbafde55211c3ba928f09d775850aa0feb754b2e68f6d94af143e6e92aed108ab2e4832f73c8b1f216c8f8e2148c63ca0a682d6362f6d40986d097fcccc700048cc1ed8fb1d26cb05c1480b07a9c02edfa072f3f41aae06ff131f4282a7a22dfdd0e03d9f655195a6ea05173f6f8fd716ca80a0122f899fe0563f12dc854c42c5667b24986eafbba65d3a83890c9e910a28cc0fa047300e68c03eaf009b979387a355fc4b01892945dada59eb66e6eb951e5637a5a0392f1635909122fe001e28ddcb765f65c30c20bd9d9e433c1daa99f7d8ba3c3a80a0d710f201fb84d85b235c4a9e4eb5f9a330dea4ce9f5785b6fd2c8ec0d51fb2fca094149d8b6cd12051aa665bca733275ed59f27e10bb9f81ccfb4b7fa6b1745feba0cf17c46b84eb04e111548e53995f415fb6d3f5a7b2233b037057882736696658a07747ec365e0b6fc4dce4a73836835dfe4e7f4f3ab9d462bed6ec142325b05bcca0948c2a50a2359901b2ae6d12a977e1a92231ab1be63440bfb20939e9d7b7d4078080f8679e2002985f24bab0ad38e09d20ce52b3f9c8aa96c1c337c9745b2f1411594eb846f8440180a03fcbafa6ca73b02e94389366045bb7af054fed82efb39b73d62a8a540bd22d85a088d7dd23f7f709c1f89fde0acb20211e8f4fcc1dfb2f9c4f84672583cc29d649c0"``
